{% extends 'admin/change_form.html' %}
{% load i18n %}
{% load bootstrap5 %}
{% if not is_popup %}
{% block breadcrumbs %}
<ol class="breadcrumb">
    <li class="home">
        <a href="{% url 'admin:index' %}" title="{% trans 'Home' %}"><span class="glyphicon glyphicon-home"></span></a>
    </li>
    <li>
        <a href="#">
            {{ opts.app_config.verbose_name }}
        </a>
    </li>
    <li>
        {% if has_change_permission %}
        <a href="#">
            {{ opts.verbose_name_plural|capfirst }}
        </a>
        {% else %}
        {{ opts.verbose_name_plural|capfirst }}
        {% endif %}
    </li>
    <li class="active">
        {% if add %}{% trans 'Add' %} {{ opts.verbose_name }}{% else %}{{ original|truncatewords:"18" }}{% endif %}
    </li>
</ol>   
{% endblock %}
{% endif %}

{% block content %}
<div class="puchase-product__container">
    <div class="pruchase-product__info-container">
        <div class="puchase-product__info"><label>–¢–æ–≤–∞—Ä: </label> <span>{{ title }}</span> <span>SKU: ({{ id }})</span></div>
        <div class="puchase-product__info"><label>–¶–≤–µ—Ç: </label> <span>{{ color }}</span></div>
        <div class="puchase-product__info"><label>–†–∞–∑–º–µ—Ä: </label> <span>{{ size }}</span></div>
        <div class="puchase-product__info">
            <label>–ë—Ä–µ–Ω–¥:</label> 
            <span> <a href="{{ brand_url }}">{{ brand }}</a></span>
        </div>
        <div class="puchase-product__info"><label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label> <span> {{ category }}</span></div>
        <div class="puchase-product__info"><label>–£—Å–ª–æ–≤–∏–µ –≤—ã–∫—É–ø–∞:</label> <span> {{ condition }}</span></div>
        <div class="puchase-product__info">
            <label>–ó–∞–∫–∞–∑ ‚Ññ:</label> 
            <span> <a href="{{ order_url }}">{{ order }}</a></span>
        </div>

        <div class="puchase-product-statistic">
            <div class="puchase-product__statistic-title">–ó–∞–∫–∞–∑–∞–Ω–æ:</div>
            <div class="puchase-product__statistic-data">
                <p>–≤ —Ç–µ–∫—É—â–µ–º –∑–∞–∫–∞–∑–µ: {{ count_in_order }}</p>
                <p>–≤—Å–µ–≥–æ: {{ count_total }}</p>
            </div>
        </div>
    </div>

    <div class="puchase-product__prev-video">
        {% if videos %}
        <p class="pruchase-product__prev-video-title"><label>–í–∏–¥–µ–æ —Ç–æ–≤–∞—Ä–∞:</label></p>
        {% for video in videos %}
        <img src="{{ video.video_preview }}" width="100" height="75">
        {% endfor %}
        {% endif %}
    </div>

    <div class="puchase-product__prev-photo">
        {% if photos %}
        <p class="pruchase-product__prev-photo-title"><label>–§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞:</label></p>
        {% for photo in photos %}
        <img src="{{ photo.image_thumb }}" width="75" height="100">
        {% endfor %}
        {% endif %}
    </div>

    <div class="puchase-product__comment-title">
        <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ —Ç–æ–≤–∞—Ä—É:</label>
        <p>{{ product_comment.comment }}</p>

        <div class="puchase-product__form-container">
            <form class="puchase-product__form" action="create_message_order_item/" method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="puchase-product__form-left">
                    <label>–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</label>
                    <textarea class="puchase-product__text-comment" type="text" name="message"></textarea>
                </div>
                <div class="puchase-product__form-right">
                    <input class="puchase-product__coommite-id" type="hidden" id="item_id" name="item_id" value="{{item_id}}">
                    <div class="input__wrapper">
                        <input class="puchase-product__btn-file" type="file" name="files" multiple>
                        <label for="puchase-product__btn-file" class="input__file-button">
                            <span class="input__file-icon-wrapper">üìå</span>
                            <span class="input__file-button-text">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª</span>
                        </label>
                    </div>                    
                    <button class="puchase-product__apply-form" type="submit" value="–û—Ç–ø—Ä–∞–≤–∏—Ç—å" name="_create_message_order_item">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>

            </form>

            <div class="puchase-product__correspondence-container">
                <div class="puchase-product__correspondence-title"><label>–ü–µ—Ä–µ–ø–∏—Å–∫–∞ –ø–æ —Ç–æ–≤–∞—Ä—É:</label></div>
                <div class="puchase-product__correspondence-message-container">
                    {% for item in correspondence_order_item %}
                    <div class="puchase-product__correspondence-message puchase-product__correspondence-message--{{ item.author }}">
                        <p class="puchase-product__correspondece-message-athor">{{ item.author }} ({{ item.created_at }}):</p>
                        <p class="puchase-product__correspondence-message-text">{{ item.message }}</p>

                        {% if item.photos %}
                        <p class="puchase-product__correspondence-message-photo">–§–æ—Ç–æ:</p>
                        {% for photo in item.photos %}
                        <img src="{{ photo.image_thumb }}" width="75" height="100">
                        {% endfor %}
                        {% endif %}
                    </div>
        
                    {% endfor %}
                </div>
            </div>

        </div>
    </div>

    <div>
        {% if product_comment.videos %}
        <p class="puchase-product__correspondence-message-video">–í–∏–¥–µ–æ:</p>
        {% for video in product_comment.videos %}
        <img src="{{ video.video_preview }}" width="100" height="75">
        {% endfor %}
        {% endif %}
    </div>

    <div class="puchase-product__correspondence-comment-photo">
        {% if product_comment.photos %}
        <p class="pruchase-product__correspondence-comment-photo-title">–§–æ—Ç–æ:</p>
        {% for photo in product_comment.photos %}
        <img src="{{ photo.image_thumb }}" width="75" height="100">
        {% endfor %}
        {% endif %}
    </div>

    <div class="puchase-product__comment-to-order">
        <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É:</label>
        <p>{{ order_comment|safe }}</p>
    </div>
    
    <div class="puchase-product__comment-title">
        

        <div class="puchase-product__form-container">
            <form class="puchase-product__form" action="create_message/" method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="puchase-product__form-left">
                    <label>–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</label>
                    <textarea class="puchase-product__text-comment" type="text" name="message"></textarea>
                </div>
                <div class="puchase-product__form-right">
                    <input class="puchase-product__coommite-id" type="hidden" id="item_id" name="item_id" value="{{item_id}}">
                    <div class="input__wrapper">
                        <input class="puchase-product__btn-file" type="file" name="files" multiple>
                        <label for="puchase-product__btn-file" class="input__file-button">
                            <span class="input__file-icon-wrapper">üìå</span>
                            <span class="input__file-button-text">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª</span>
                        </label>
                    </div>
                    <button class="puchase-product__apply-form" type="submit" value="–û—Ç–ø—Ä–∞–≤–∏—Ç—å" name="_create_message">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
            </form>

            <div class="puchase-product__correspondence-container">
                <div class="puchase-product__correspondence-title"><label>–ü–µ—Ä–µ–ø–∏—Å–∫–∞ —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–º:</label></div>
                <div class="puchase-product__correspondence-message-container">
                    {% for item in correspondence %}

                    <div class="puchase-product__correspondence-message puchase-product__correspondence-message--{{ item.author }}">
                        <p class="puchase-product__correspondece-message-athor">{{ item.author }} ({{ item.created_at }}):</p>
                        <p class="puchase-product__correspondence-message-text">{{ item.message }}</p>
                        {% if item.videos %}
                        <p class="puchase-product__correspondence-message-video">–í–∏–¥–µ–æ:</p>
                        {% for video in item.videos %}
                        <img src="{{ video.video_preview }}" width="100" height="75">
                        {% endfor %}
                        {% endif %}
                        {% if item.photos %}
                        <p class="puchase-product__correspondence-message-photo">–§–æ—Ç–æ:</p>
                        {% for photo in item.photos %}
                        <img src="{{ photo.image_thumb }}" width="75" height="100">
                        {% endfor %}
                        {% endif %}
                    </div>

                    {% endfor %}
                </div>
            </div>
        </div>

    </div>
{% endblock %}



